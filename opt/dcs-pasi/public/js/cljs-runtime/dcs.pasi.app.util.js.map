{"version":3,"sources":["dcs/pasi/app/util.cljs"],"mappings":"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","names":["dcs.pasi.app.util/now","js/Date","dcs.pasi.app.util/secs-to-now","start-time","dcs.pasi.app.util/date-str","year","quarter","q-map","dcs.pasi.app.util/vega-embed-opts","dcs.pasi.app.util/easier-repo","dcs.pasi.app.util/easier-repo-data","dcs.pasi.app.util/open-tab","event","tab-group-suffix","tab-id","seq__45085","cljs.core/seq","chunk__45086","count__45087","i__45088","temp__5753__auto__","cljs.core/chunked-seq?","c__4679__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/first","cljs.core/next","tab-content","js/document","seq__45089","chunk__45090","count__45091","i__45092","tab","clojure.string/replace","var_args","G__45094","dcs.pasi.app.util/scroll-fn","js/Error","id","ele","_e","mousedown-handler","scrolledY","js/window"],"sourcesContent":["(ns dcs.pasi.app.util\n  (:require [clojure.string :as str]))\n\n(defn now\n      \"Milliseconds since epoch\"\n      []\n      (.now js/Date))\n\n(defn secs-to-now\n      [start-time]\n      (double (/ (- (now) start-time) 1000)))\n\n(defn date-str\n      [year quarter]\n      (let [q-map {1 \"31 Mar\"\n                   2 \"30 Jun\"\n                   3 \"31 Aug\"\n                   4 \"31 Dec\"}]\n           (str (q-map quarter) \" \" year)))\n\n(def vega-embed-opts\n  ;; hide Vega's 3-dot menu\n  {:actions false}\n  ;; alternatively, to display Vega's 3-dot menu, uncomment...\n  #_{:actions          {:export   true\n                      :source   false\n                      :compiled false\n                      :editor   false}\n   :downloadFileName \"PASI-visualisation\"\n   :scaleFactor      2\n   ;; experiment to access and use Vega's View API, requires metasoarous/oz 1.6.0-alpha35-SNAPSHOT (or later)\n   #_:view-callback #_(fn [view]\n                    (js/console.log \"executing view-callback option to oz/vega-lite component\")\n                    (js/console.log \"view object\" view)\n                    (.addEventListener view \"mouseover\" (fn [event item]\n                                                          (js/console.log \"item: \" item)\n                                                          (when (some-> item .-datum .-annotation)\n                                                            (js/console.log \"It's an annotation\")\n                                                            (let [datum (.-datum item)]\n                                                              (js/console.log \"datum: \" datum))\n                                                            (.preventDefault event) ;; hmmm, does this do anything?\n                                                            ))))\n   })\n\n;; For dcs-easier-open-data URLs I want to use the stem\n;;   https://github.com/data-commons-scotland/dcs-easier-open-data/raw/v1.0-beta/data/\n;; but it results in a \"redirect\"+\"cross site restriction\" problem.\n;; So, instead use the \"more direct\" stem:\n(def easier-repo \"https://raw.githubusercontent.com/data-commons-scotland/dcs-easier-open-data/v1.6-beta/\")\n(def easier-repo-data (str easier-repo \"data/\"))\n\n\n(defn open-tab [event tab-group-suffix tab-id]\n      (doseq [tab-content (.getElementsByClassName js/document (str \"tab-content-\" tab-group-suffix))]\n             (set! (.-display (.-style tab-content)) \"none\"))\n      (doseq [tab (.getElementsByClassName js/document (str \"tab-\" tab-group-suffix))]\n             (set! (.-className tab) (str/replace (.-className tab) \" is-active\" \"\")))\n      (set! (.-display (.-style (.getElementById js/document (str tab-id \"-\" tab-group-suffix)))) \"block\")\n      (set! (.-className (.-currentTarget event)) (str (.-className (.-currentTarget event)) \" is-active\")))\n\n\n(defn scroll-fn\n  ([id]\n   (fn []\n     (when-let [ele (.getElementById js/document id)]\n       (.scrollIntoView ele true)\n       (.add (.-classList ele) \"is-selected\")\n      ;; a hacky way of de-selecting\n       (letfn [(mousedown-handler [_e]\n                 (.remove (.-classList ele) \"is-selected\")\n                 (.removeEventListener js/document \"mousedown\" mousedown-handler))]\n         (.addEventListener js/document \"mousedown\" mousedown-handler))\n      ;; allow for the navbar area when scrolling-into-view a specific element\n       (when-let [scrolledY (.-scrollY js/window)]\n         (.scroll js/window 0 (- scrolledY 65))))))\n  ([]\n   (fn []\n     (.scroll js/window 0 0))))\n\n"]}