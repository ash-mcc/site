{"version":3,"sources":["dcs/pasi/app/view/unauthenticated/cars.cljs"],"mappings":";AASA,yDAAA,zDAAMA,0HACHC;AADH,AAAA,kDAAA,0DAAA,6CAAA,sDAAA,2CAAA,qDAAA,2CAAA,qEAAA,+DAAA,mFAAA,2CAAA,8DAAA,cAAA,wDAAA,KAAA,iDAAA,kBAAA,2CAAA,+DAAA,mFAAA,2CAAA,kDAAA,MAAA,wDAAA,YAAA,iDAAA,4BAAA,2DAAA,mFAAA,kCAAA,wDAAA,mFAAA,2CAAA,qDAAA,2CAAA,qDAAA,MAAA,oFAAA,IAAA,sFAAA,YAAA,6DAAA,2CAAA,+CAAA,2CAAA,sDAAA,eAAA,wDAAA,UAAA,qDAAA,WAAA,sDAAA,2CAAA,8DAAA,4GAAA,gEAAA,KAAA,gEAAA,2CAAA,6DAAA,QAAA,qDAAA,IAAA,uDAAA,oBAAA,uDAAA,2CAAA,yDAAA,mFAAA,sBAAA,2CAAA,oDAAA,wCAAA,gDAAA,2CAAA,sDAAA,aAAA,wDAAA,YAAA,qDAAA,eAAA,uDAAA,2CAAA,yDAAA,mFAAA,IAAA,8BAAA,4DAAA,mFAAA,2CAAA,sDAAA,eAAA,wDAAA,UAAA,qDAAA,WAAA,0DAAA,iBAAA,2CAAA,sDAAA,aAAA,wDAAA,YAAA,qDAAA,eAAA,0DAAA,8CAAA,wDAAA,2CAAA,uDAAA,2CAAA,oDAAA,n/IAOuBA;;AAmCvB,8CAAA,9CAAMC;AAAN,AACK,UAAA,AAAAC,NAAMC,sBAAQC;IACRC,SAAOF;AADb,AAAA,0FAEGG,kBAAa,AAACP,uDAAgBM,QAAQE","names":["dcs.pasi.app.view.unauthenticated.cars/cars-chart-spec","data","dcs.pasi.app.view.unauthenticated.cars/root","cljs.core/deref","raw","dcs.pasi.app.state/unauthn-wr-ds-cursor","counts","oz.core/vega-lite","dcs.pasi.app.util/vega-embed-opts"],"sourcesContent":["(ns dcs.pasi.app.view.unauthenticated.cars\n  (:require [cljs.spec.alpha :as s]\n[clojure.string :as str]\n            [reagent.core :as r]\n             [oz.core :as oz]\n            [dcs.pasi.app.util :as util]\n            [dcs.pasi.app.state :as state]\n            [dcs.pasi.app.view.datagrid :as datagrid]))\n\n(defn cars-chart-spec\n  [data]\n  {:schema    \"https://vega.github.io/schema/vega/v5.json\"\n   ;:width      500\n   ;:height     500\n   ;:background \"#f2dfce\"\n   :title     \"cars worth of carbon savings per quarter\"\n   :data      {:values data}\n   :transform [{:timeUnit \"yearquarter\"\n                :field    \"to\"\n                :as       \"quarter\"}\n               {:aggregate [{:op    \"sum\" ;; TODO calc this properly\n                             :field \"itemCount\"\n                             :as    \"itemCount\"}]\n                :groupby   [\"quarter\"]}]\n   :layer     [{:mark     {:type                 \"bar\"\n                           :cornerRadiusTopLeft  3\n                           :cornerRadiusTopRight 3}\n                :encoding {:x       {:title \"year quarter\"\n                                     :field \"quarter\"\n                                     :type  \"temporal\"\n                                     :axis  {:labelExpr  \"timeFormat(datum.value, '%q') == '1' ? timeFormat(datum.value, 'Q%q %Y') : timeFormat(datum.value, 'Q%q')\"\n                                             :labelAngle 90\n                                             :tickCount  {:interval \"month\"\n                                                          :step     3\n                                                          :start    0}}\n                                     :scale {:domain [\"2016-01-01T00:00:00\" {:expr \"now()\"}]}}\n                           :y       {:title \"item count\"\n                                     :field \"itemCount\"\n                                     :type  \"quantitative\"\n                                     :scale {:domain [0 200]}}\n                           :tooltip [{:title  \"year quarter\"\n                                      :field  \"quarter\"\n                                      :type   \"temporal\"\n                                      :format \"Q%q %Y\"}\n                                     {:title  \"item count\"\n                                      :field  \"itemCount\"\n                                      :type   \"quantitative\"\n                                      :format \".0f\"}]}}]\n   :config    {:axisX {:grid false}}})\n\n\n(defn root []\n     (let [raw    @state/unauthn-wr-ds-cursor\n           counts raw]\n       [oz/vega-lite (cars-chart-spec counts) util/vega-embed-opts]))\n"]}